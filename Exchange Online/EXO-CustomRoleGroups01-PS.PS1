<# Comment out the features you want to KEEP in your custom role 
    This is based off of the "Mail Recipients" Role
    #>
$entries = @("Add-MailboxFolderPermission",       
    "Add-MailboxPermission",        
    "Add-RecipientPermission"
    "Add-UnifiedGroupLinks",
    "Clear-ActiveSyncDevice",
    "Clear-MobileDevice",
    "Disable-InboxRule",
    "Disable-Mailbox",
    "Disable-SweepRule",
    "Enable-InboxRule",
    "Enable-Mailbox",
    "Enable-SweepRule",
    "Get-AcceptedDomain",
    "Get-ActiveSyncDevice",
    "Get-ActiveSyncDeviceStatistics",
    "Get-ActiveSyncMailboxPolicy",
    "Get-AddressBookPolicy", 
    "Get-CalendarProcessing",
    "Get-CASMailbox",
    "Get-CASMailboxPlan",
    "Get-Clutter",
    #"Get-Contact",
    "Get-EventsFromEmailConfiguration",
    "Get-ExoJob",
    "Get-FocusedInbox",
    "Get-GroupMailbox",
    "Get-HotmailSubscription",
    "Get-ImapSubscription",
    "Get-InboxRule",
    "Get-LogonStatistics",
    #"Get-Mailbox",
    "Get-MailboxAutoReplyConfiguration",
    "Get-MailboxCalendarConfiguration",
    "Get-MailboxCalendarFolder",
    "Get-MailboxFolderPermission",
    "Get-MailboxFolderStatistics",
    "Get-MailboxJunkEmailConfiguration",
    "Get-MailboxLocation",
    "Get-MailboxMessageConfiguration",
    "Get-MailboxOverrideConfiguration",
    "Get-MailboxPermission",
    "Get-MailboxPlan",
    "Get-MailboxPreferredLocation",
    "Get-MailboxRegionalConfiguration",
    "Get-MailboxSpellingConfiguration",
    "Get-MailboxStatistics",
    "Get-MailboxUserConfiguration",
    #"Get-MailContact",
    #"Get-MailUser",
    "Get-ManagementRoleAssignment",
    "Get-MessageCategory",
    "Get-MessageClassification",
    "Get-MessageRecallResult",
    "Get-MobileDevice",
    "Get-MobileDeviceMailboxPolicy",
    "Get-MobileDeviceStatistics",
    "Get-OnlineMeetingConfiguration",
    "Get-OrganizationalUnit",
    "Get-OwaMailboxPolicy",
    "Get-Place",
    "Get-PopSubscription",
    "Get-RbacDiagnosticInfo",
    #"Get-Recipient",
    "Get-RecipientPermission",
    "Get-RecipientStatisticsReport",
    "Get-RoleAssignmentPolicy",
    "Get-SendAddress",
    "Get-SenderPermission",
    "Get-ServiceStatus",
    "Get-SiteMailbox",
    "Get-SiteMailboxProvisioningPolicy",
    "Get-Subscription",
    "Get-SweepRule",
    "Get-SyncRequest",
    "Get-SyncRequestStatistics",
    "Get-ToolInformation",
    "Get-UMMailboxPlan",
    "Get-UnifiedAuditSetting",
    "Get-UnifiedGroup",
    "Get-UnifiedGroupLinks",
    #"Get-User",
    "Get-UserPhoto",
    "Import-ContactList",
    "Import-RecipientDataProperty",
    "New-InboxRule",
    "New-Mailbox",
    "New-OwaMailboxPolicy",
    "New-SweepRule",
    "New-UnifiedGroup",
    "Receive-ExoJob",
    "Remove-ActiveSyncDevice",
    "Remove-ExoJob",
    "Remove-HybridConfiguration",
    "Remove-InboxRule",
    "Remove-MailboxFolderPermission",
    "Remove-MailboxLocation",
    "Remove-MailboxPermission",
    "Remove-MailboxUserConfiguration",
    "Remove-MobileDevice",
    "Remove-OwaMailboxPolicy",
    "Remove-RecipientPermission",
    "Remove-Subscription",
    "Remove-SweepRule",
    "Remove-SyncRequest",
    "Remove-UnifiedGroup",
    "Remove-UnifiedGroupLinks",
    "Remove-UserPhoto",
    "Reset-EventsFromEmailBlockStatus",
    "Resume-SyncRequest",
    "Set-CalendarProcessing",
    "Set-CASMailbox",
    "set-CASMailboxPlan",
    "Set-Clutter",
    #"Set-Contact",
    "Set-EventsFromEmailConfiguration",
    "Set-FocusedInbox",
    "Set-Group",
    "Set-GroupMailbox",
    "Set-HotmailSubscription",
    "Set-ImapSubscription",
    "Set-InboxRule",
    "Set-LinkedUser",
    #"Set-Mailbox",
    "Set-MailboxAutoReplyConfiguration",
    "Set-MailboxCalendarConfiguration",
    "Set-MailboxCalendarFolder",
    "Set-MailboxJunkEmailConfiguration",
    "Set-MailboxLocation",
    "Set-MailboxMessageConfiguration",
    "Set-MailboxPlan",
    "Set-MailboxRegionalConfiguration",
    "Set-MailboxSpellingConfiguration",
    #"Set-MailContact",
    #"Set-MailUser",
    "Set-OrganizationConfig",
    "Set-OwaMailboxPolicy",
    "Set-Place",
    "Set-PopSubscription",
    "Set-SweepRule",
    "Set-SyncRequest",
    "Set-UnifiedAuditSetting",
    "Set-UnifiedGroup",
    #"Set-User",
    "SetUserPhoto",
    "Set-UserPhoto",
    "Start-AuditAssistant",
    "Stop-ExoJob",
    "Suspend-SyncRequest",
    "Test-DatabaseEvent",
    "Test-InformationBarrierPolicy",
    "Test-InvitationManager",
    "Test-MailboxAssistant",
    "Test-MAPIConnectivity",
    "Test-OAuthConnectivity",
    "Update-HybridConfiguration",
    "Update-MaskingIndex",
    #"Update-Recipient",
    "Upgrade-DistributionGroup",
    "Write-AdminAuditLog")

<# Loop through the list and remove all the features that are not commented out #>
foreach ($e in $entries) { Remove-ManagementRoleEntry -Identity "contact managers\$($e)" -confirm:$false } 

<# Sanity check to make sure that the list contains only the number of items you wanted #>
(Get-ManagementRoleEntry "contact managers\*" | sort name).count

<# Comment out the features you want to KEEP in your custom role 
    This is based off of the "Mail Recipient Creation" Role
    #>

$entriesCreation = @("Add-MailboxLocation",
    "Disable-JournalArchiving",
    "Get-ActiveSyncMailboxPolicy",
    "Get-AddressBookPolicy",
    "Get-DataEncryptionPolicy",
    "Get-LinkedUser",
    #"Get-Mailbox",
    "Get-MailboxPlan",
    "Get-MailboxPreferredLocation".
    #"Get-MailContact",
    #"Get-MailUser",
    "Get-ManagementRoleAssignment",
    "Get-MessageRecallResult",
    "Get-MobileDeviceMailboxPolicy",
    "Get-Notification",
    "Get-OrganizationalUnit",
    "Get-Place",
    "Get-RbacDiagnosticInfo",
    #"Get-Recipient",
    "Get-RoleAssignmentPolicy",
    "Get-SenderPermission",
    "Get-SharingPolicy",
    "Get-ToolInformation",
    "Get-UnifiedAuditSetting",
    #"Get-User",
    "Invoke-BirthdayCalendarSync",
    "Invoke-ShadowCalendarSync",
    "New-DataEncryptionPolicy",
    "New-Mailbox",
    #"New-MailContact",
    #"New-MailUser",
    "New-SchedulingMailbox",
    "Remove-CalendarEvents",
    "Remove-Mailbox",
    #"Remove-MailContact",
    #"Remove-MailUser",
    "Reset-ShadowCalendar",
    "Set-DataEncryptionPolicy",
    "Set-MailboxFolderPermission",
    "Set-Notification",
    "Set-Place",
    "Set-UnifiedAuditSetting",
    "Start-AuditAssistant",
    "Test-DatabaseEvent",
    "Test-DataEncryptionPolicy",
    "Test-MailboxAssistant",
    "Undo-SoftDeletedMailbox",
    "Undo-SoftDeletedUnifiedGroup",
    "Validate-ShadowCalendar"      
    "Write-AdminAuditLog")

<# Loop through the list and remove all the features that are not commented out #>
foreach ($ec in $entriesCreation) { Remove-ManagementRoleEntry -Identity "Contact Creators\$($ec)" -confirm:$false } 

<# Sanity check to make sure that the list contains only the number of items you wanted #>
(Get-ManagementRoleEntry "contact creators\*" | sort name).count

<# Comment out the features you want to KEEP in your custom role 
    This is based off of the "Distribution Groups" Role
    #>

$entriesdg = @(#"Add-DistributionGroupMember",
    "Get-AcceptedDomain",
    #"Get-DistributionGroup",
    #"Get-DistributionGroupMember",
    "Get-DynamicDistributionGroup",
    "Get-DynamicDistributionGroupMember",
    "Get-EligibleDistributionGroupForMigration",
    "Get-ExoJob",
    "Get-Group",
    "Get-Mailbox",
    "Get-MailboxPreferredLocation",
    "Get-MailUser",
    "Get-MessageRecallResult",
    "Get-OrganizationalUnit",
    "Get-Recipient",
    "Get-SenderPermission",
    "Get-UnifiedAuditSetting",
    "Get-User",
    "New-DistributionGroup",
    "New-DynamicDistributionGroup",
    "Receive-ExoJob",
    "Remove-DistributionGroup",
    #"Remove-DistributionGroupMember",
    "Remove-DynamicDistributionGroup",
    "Remove-ExoJob",
    #"Set-DistributionGroup",
    "Set-DynamicDistributionGroup",
    "Set-Group",
    "Set-OrganizationConfig",
    "Set-UnifiedAuditSetting",
    "Start-AuditAssistant",
    "Stop-ExoJob",
    "Test-DatabaseEvent",
    "Test-MailboxAssistant",
    #"Update-DistributionGroupMember",
    "Write-AdminAuditLog"
)

<# Loop through the list and remove all the features that are not commented out #>
foreach ($edg in $entriesdg) { Remove-ManagementRoleEntry -Identity "DistributionList Managers\$($edg)" -confirm:$false } 

<# Sanity check to make sure that the list contains only the number of items you wanted #>
(Get-ManagementRoleEntry "DistributionList Managers\*" | sort name).count